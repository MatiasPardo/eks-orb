description: perform the check of completion of the deployment in staging
executor: << parameters.executor >>
parameters:
  executor:
    default: default
    description: Executor to use for this job
    type: executor
  type-name:
    default: deployment
    description: declaration of k8s resource - deployment, statefulset etc
    type: string
  cluster-name:
    description: EKS cluster name
    type: string
  region:
    description: AWS region where the eks clust er is located
    type: string
  release-name:
    description: kubernetes deployment name
    type: string
  namespace:
    description: kubernetes namespace name
    type: string
  checkout:
    type: boolean
    description: Boolean for whether or not to checkout as a first step. Default is true.
    default: true
steps:
  - when:
      condition: << parameters.checkout >>
      steps:
        - checkout
  - update-kubeconfig-with-authenticator:
      cluster-name: << parameters.cluster-name >>
      aws-region: << parameters.region >>
  - run:
      name: Rollout Status
      command: kubectl -n << parameters.namespace >> rollout status << parameters.type-name >> << parameters.release-name >>
